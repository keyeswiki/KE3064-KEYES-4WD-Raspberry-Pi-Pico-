# 第05课 循迹传感器
![Img](./media/8b051f7e023b717bbbe5766142bc3663.png)
## 1.实验说明：                                                                                 
循迹传感器实际上是红外传感器。 在小车驱动底板的前面有3路巡线，此处使用的组件是TCRT5000红外灯管。 其工作原理是利用红外光对颜色的不同反射率，然后将反射信号的强度转换为电流信号。 在检测过程中，黑色在高电平时处于活动状态，而白色在低电平时处于活动状态，即检测到黑色时或者近距离没有检测到物体时输出高电平，检测到白色或者光滑易反射光的物体时输出低电平。 检测高度为0-3厘米。 底板上方还有3个蓝色旋转电位器，通过旋转这些电位器，可以调节传感器的检测灵敏度。

## 2.相关知识：
- 工作电压: 3.3-5V (DC)
- 接口: 5PIN接口(左边循迹传感器接G16,中间循迹传感器接G17,右边循迹传感器接G18,5V,G)
- 输出信号: 数字信号
- 检测高度: 0-3 cm

**红外循迹传感器：** 红外循迹传感器的红外对管分为两部分，一部分是红外发射端，另一部分是红外接收端。
![Img](./media/8b45022c3d8e2f74f2b44121d8d7eb65.png)
黑线或黑色物体对红外线有很好的吸收效果。当红外循迹发射端向黑线发射时，发射的红外线被吸收而未形成反射信号，红外循迹接收端未接收到信号，这样红外循迹输出高电平(1);白线或白色物体对红外线没有吸收作用，红外循迹发射端的红外信号会反射回接收端，这样红外循迹输出低电平(0)。

下表给出了小车底板上的红外循迹传感器检测不同颜色物体的所有情况下的数值。其中检测到黑线、黑色物体或无物体代表1，检测到白线或白色物体代表0。
![Img](./media/9c61aaf1c898cac65108d6761167f6e9.png)

|左红外循迹传感器|中间红外循迹传感器|右红外循迹传感器|值（二进制）|
| :--: | :--: |:--:| :--: |
|0|0|0|000|
|0|0|1|001|
|0|1|0|010|
|0|1|1|011|
|1|0|0|100|
|1|0|1|101|
|1|1|0|110|
|1|1|1|111|

<span style="color: rgb(255, 76, 65);">警告：反射式光学传感器(包括红外循迹)应避免在阳光等有红外干扰的环境中使用。阳光中含有许多不可见光，如红外线和紫外线。在强光环境下，反射式光学传感器不能正常工作。</span>

## 3.实验代码：
本教程中使用的代码保存在：“**..\4. Python 教程\3. 项目课程**” 的路径中。你可以把代码移到任何地方。例如，我们将代码保存在**D盘**中，<span style="color: rgb(0, 209, 0);">路径为D:\3. 项目课程</span>。
![Img](./media/92103adf9654c97f49aea829c933d86f.png)

打开“**Thonny**”软件，点击“**此电脑**”→“**D:**”→“**3. 项目课程**”→“**第05课 循迹传感器**”，然后鼠标左键双击“**5_Tracking_Line.py**”。
![Img](./media/b5d7ee495db6dc60158ee6c0052ade6b.png)

```
'''
KEYES 4WD Raspberry Pi Pico 麦克纳姆轮智能小车
第05课
循迹传感器
'''

from machine import Pin
import time

l_pin = Pin(16, Pin.IN)
m_pin = Pin(17, Pin.IN)
r_pin = Pin(18, Pin.IN)


while True:
    l_val = l_pin.value() #读取左边巡线传感器的值
    m_val = m_pin.value() #读取中间巡线传感器的值
    r_val = r_pin.value() #读取右边巡线传感器的值
    print(l_val, end = ' ')
    print(m_val, end = ' ')
    print(r_val)
    time.sleep_ms(100)
    
```

## 4.实验结果：                                                                                
确保Raspberry Pi Pico主板已经连接到电脑上，单击“![Img](./media/555a25f055ba1b4c56ee4c3a28ffe5af.png)”。
![Img](./media/1a94a0e9131d9bd678bf94b47fb2034a.png)

安上电池，将电机驱动底板上的电源拨码开关拨到ON一端，开启电源。单击“![Img](./media/5c05febdb56bb5ef370e897c012c1b91.png)”，代码开始执行。这样，在Shell窗口中，我们可以看到打印的三路巡线传感器接收到的数字信号，当我们用白纸去遮挡它的时候，输出0，用黑纸或者悬空小车的时候，输出1：
![Img](./media/f71e0844d3201ab0c83cb33b7d4aa584.png)
![Img](./media/93dfb7018cbb77a79a00dab3ca70bf42.png)

## 4.代码说明：

|![Img](./media/c387f443939270471ff75fda3cdf2da3.png)| 三路循迹传感器引脚接口定义，这里我们左边接到GPIO16，中间接GPIO17，右边接GPIO18，引脚模式全部设置为输入，因为我们想要去读取循迹传感器输出的电平信号，所以我们设置为输入模式。|
| :--: | :--: |
|l_pin.value()|读取引脚的数字电平，当这个引脚为3.3V时我们读取到的值就是1，当这个引脚为0V时，我们读取到的值就是0，读取完我们这里用一个变量l_val保存了。 |
|print(l_val, end = ' ')| 打印读取到的l_val的值，后面使用end = ' '表示不换行 |
|print(r_val)|换行打印r_val的值|

